<!-- build time:Wed Nov 25 2020 04:47:22 GMT+0000 (Coordinated Universal Time) --><!DOCTYPE html><html><head><meta name="generator" content="Hexo 3.9.0"><meta charset="utf-8"><title>ES7 decorator æ·±å…¥æ¢æ | Keep Moving | Follow ur heart</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="keywords" content="javascript,decorator"><link rel="shortcut icon" href="/img/favicon.png"><link rel="stylesheet" href="/css/style.css?v=1.2.6"><script type="text/javascript">var DC={reward:!0,lv:JSON.parse('{"enable":true,"app_id":"LSbj8deFCLr0XdOxT6aGGld9-gzGzoHsz","app_key":"u5T5LgryYWwkfxkw0kjSsTcJ","icon":true}'),v:JSON.parse('{"enable":true,"appid":"LSbj8deFCLr0XdOxT6aGGld9-gzGzoHsz","appkey":"u5T5LgryYWwkfxkw0kjSsTcJ","notify":true,"verify":true,"placeholder":"å¦‚æ‚¨æœ‰å…¶ä»–å»ºè®®ï¼Œå¯ä»¥é€šè¿‡å·¦ä¸Šè§’çš„QQå‘èµ·å›è¯ï¼Œæˆ–è€…åœ¨ https://zq-jhon.github.io/about/ ä¸­æ·»åŠ æˆ‘çš„å¾®ä¿¡","avatar":"retro"}'),g:JSON.parse("{}")}</script><script type="text/javascript">window.lazyScripts=[]</script></head><meta name="referrer" content="no-referrer"><body><div id="loading" class="active"></div><aside id="menu" class="hide"><div class="inner flex-row-vertical"><a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off"><i class="icon icon-lg icon-close"></i></a><div class="brand-wrap"><img src="/img/brand.png" class="brand-bg"><div class="brand"><a href="/" class="avatar waves-effect waves-circle waves-light"><img src="/img/avatar.png"></a><hgroup class="introduce"><h5 class="nickname">ZQ-jhon</h5><a href="mailto:zhangqiang199411@gmail.com" title="zhangqiang199411@gmail.com" class="mail"><span>z</span> <span>h</span> <span>a</span> <span>n</span> <span>g</span> <span>q</span> <span>i</span> <span>a</span> <span>n</span> <span>g</span> <span>1</span> <span>9</span> <span>9</span> <span>4</span> <span>1</span> <span>1</span> <span>@</span> <span>g</span> <span>m</span> <span>a</span> <span>i</span> <span>l</span> <span>.</span> <span>c</span> <span>o</span> <span>m</span></a></hgroup><ul class="menu-link"><li><a href="http://sighttp.qq.com/authd?IDKEY=1c72f08d824e28c2b7c02e5b43e8e6a04124774470d4dcce" target="_blank"><i class="icon icon-lg icon-qq"></i></a></li></ul></div></div><div class="scroll-wrap flex-col"><ul class="nav"><li><a href="/"><i class="icon icon-lg icon-home"></i> é¦–é¡µ</a></li><li><a href="/archives"><i class="icon icon-lg icon-archives"></i> æ¦‚è§ˆ</a></li><li><a href="/daily-news"><i class="icon icon-lg icon-newspaper-o"></i> æ—¥æŠ¥</a></li><li><a href="/about"><i class="icon icon-lg icon-user"></i> å…³äº</a></li><li><a href="/projects"><i class="icon icon-lg icon-github"></i> é¡¹ç›®</a></li><li><a href="/categories"><i class="icon icon-lg icon-plus-square"></i> ç•™è¨€æ¿</a></li><li><a href="https://github.com/ZQ-jhon" target="_blank"><i class="icon icon-lg icon-github"></i> Github</a></li></ul></div></div></aside><main id="main"><header class="top-header" id="header"><div class="flex-row clearfix"><a href="javascript:;" class="header-icon pull-left waves-effect waves-circle waves-light on" id="menu-toggle"><i class="icon icon-lg icon-navicon"></i></a><div class="flex-col header-title ellipsis"><span>ES7 decorator æ·±å…¥æ¢æ</span></div><a href="javascript:;" id="site_search_btn" class="header-icon pull-right waves-effect waves-circle waves-light"><i class="icon icon-lg icon-search"></i></a></div></header><header class="content-header post-header"><img src="/img/banner.png" class="header-bg"><div class="container fade-scale"><h1 class="title">ES7 decorator æ·±å…¥æ¢æ</h1><h5 class="subtitle"><time datetime="2019-06-13T22:23:00.000Z" itemprop="datePublished" class="page-time">2019-06-13</time></h5></div></header><div id="site_search"><div class="search-title clearfix"><span class="pull-left"><i class="icon icon-lg icon-search"></i> </span><input type="text" id="local-search-input" name="q" results="0" placeholder="çœ‹èƒ½æœå‡ºç‚¹å•¥" class="form-control pull-left"> <a href="javascript:;" class="close pull-right waves-effect waves-circle waves-light"><i class="icon icon-lg icon-close"></i></a></div><div id="local-search-result"></div></div><div class="container body-wrap"><article id="post-ES7 decorator æ·±å…¥æ¢æ" class="post-article article-type-post" itemprop="blogPost"><div class="post-card"><h1 class="post-card-title">ES7 decorator æ·±å…¥æ¢æ</h1><div class="post-meta"><time class="post-time" title="2019-06-13 22:23:00" datetime="2019-06-13T22:23:00.000Z" itemprop="datePublished">2019-06-13</time> <span id="/2019/06/13/ES7 decorator æ·±å…¥æ¢æ/" class="leancloud_visitors" data-flag-title="ES7 decorator æ·±å…¥æ¢æ" title="ES7 decorator æ·±å…¥æ¢æ"><i class="icon icon-eye"></i> <span class="leancloud-visitors-count"></span></span> <span class="leancloud-comment"><i class="icon icon-comment-o"></i> <a href="/2019/06/13/ES7 decorator æ·±å…¥æ¢æ/#comment"><span class="valine-comment-count" data-xid="/2019/06/13/ES7 decorator æ·±å…¥æ¢æ/"></span></a></span></div><div class="post-content" id="post-content" itemprop="postContent"><p>æœ¬æ–‡ç« åŸå§‹åˆ›ä½œåœ°å€ï¼š<a href="https://blog.csdn.net/qq_20264891/article/details/91357985" target="_blank" rel="noopener">https://blog.csdn.net/qq_20264891/article/details/91357985</a></p><p>å¦‚æ‚¨æœ‰å…¶ä»–å»ºè®®ï¼Œå¯ä»¥é€šè¿‡å·¦ä¸Šè§’çš„ QQ å‘èµ·å›è¯ï¼Œæˆ–è€…åœ¨ <a href="https://zq-jhon.github.io/about/">https://zq-jhon.github.io/about/</a> ä¸­æ·»åŠ æˆ‘çš„å¾®ä¿¡</p><h3 id="èµ·å› "><a href="#èµ·å› " class="headerlink" title="èµ·å› "></a>èµ·å› </h3><p>ä¸€ç›´äº«å—ç€ Anuglar å’Œ Nest çš„çº¢åˆ©ï¼Œä¸Šæ¥å°±æ˜¯ <code>@Component(...)</code> æˆ–è€… <code>@Controller(...)</code>ï¼Œè‡ªå·±å´æ²¡æœ‰å®é™…çš„æ¢ç©¶è¿‡èƒŒåçš„åŸç†ã€‚äºæ˜¯ä»Šå¤©æƒ³å¥½å¥½æ€»ç»“ä¸€ä¸‹ï¼Œæ²‰æ·€æ²‰æ·€ã€‚</p><h3 id="å‰ç½®æ¡ä»¶ï¼ˆes5-åŸç†ï¼‰"><a href="#å‰ç½®æ¡ä»¶ï¼ˆes5-åŸç†ï¼‰" class="headerlink" title="å‰ç½®æ¡ä»¶ï¼ˆes5 åŸç†ï¼‰"></a>å‰ç½®æ¡ä»¶ï¼ˆes5 åŸç†ï¼‰</h3><p>ä¹‹å‰çœ‹è¿‡çº¢å®ä¹¦ï¼Œç¬¬å…­ç« æåˆ°è¿‡ï¼Œjs å¯¹è±¡çš„å±æ€§æœ‰å‡ ä¸ªç‰¹æ€§ï¼š</p><ol><li>[[configurable]] æ˜¯å¦å¯é…ç½®</li><li>[[enumerable]] æ˜¯å¦å¯æšä¸¾</li><li>[[writeble]] æ˜¯å¦å¯ä¿®æ”¹å€¼</li><li>[[value]] å†™å…¥çš„å€¼æ˜¯å•¥</li></ol><p><em>å››ä¸ªé…ç½®é¡¹éƒ½ä¸º boolean ç±»å‹ã€‚</em><br>è¿™å››ä¸ªé…ç½®è”åˆèµ·æ¥æœ‰ä¸€ä¸ªåå­—ï¼Œå«åš<strong>å¯¹è±¡å±æ€§çš„æè¿°ç¬¦(descriptor)</strong><br>å…¶ä¸­ï¼Œwriteble å’Œ value è¿˜æœ‰å¦å¤–ä¸€ä¸ªåå­—ï¼Œ <code>setter</code> å’Œ <code>getter</code> è®¿é—®å™¨ï¼‰ã€‚<br>ä¸Šä»£ç ï¼š<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123; &#125;;</span><br><span class="line"><span class="built_in">Object</span>.defineProperty(obj,<span class="string">'a'</span>, &#123;</span><br><span class="line">value: <span class="number">1</span>,</span><br><span class="line">writeble: <span class="literal">false</span>,</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">console</span>.log(obj); <span class="comment">// &#123;a: 1&#125;</span></span><br><span class="line"><span class="built_in">console</span>.log(obj.a) <span class="comment">// 1</span></span><br><span class="line">obj.a = <span class="number">3</span>; <span class="comment">// ä¿®æ”¹ a å±æ€§çš„å€¼</span></span><br><span class="line"><span class="built_in">console</span>.log(obj.a) <span class="comment">// 1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**====================å¦ä¸€ç§å†™æ³•====================*/</span></span><br><span class="line"><span class="keyword">const</span> d = &#123;&#125;;</span><br><span class="line"><span class="built_in">Object</span>.defineProperty(d , <span class="string">'name'</span> &#123;</span><br><span class="line">get: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;<span class="keyword">return</span> <span class="number">1</span>&#125;,</span><br><span class="line">set: <span class="function"><span class="keyword">function</span>(<span class="params">value</span>) </span>&#123;<span class="keyword">return</span> <span class="literal">false</span>&#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(d) <span class="comment">// &#123;&#125; æ³¨æ„ï¼ï¼ï¼ï¼è¿™é‡Œè·Ÿ writeble å’Œ value ä¸å¤ªä¸€æ ·ï¼Œè¿™é‡Œæ‰“å°å‡ºæ¥çš„å¯¹è±¡ï¼Œæ˜¯æ²¡æœ‰æ˜¾ç¤º name å±æ€§çš„ï¼ï¼ï¼ä½†æ˜¯è®¿é—®å¯ä»¥è®¿é—®å‡ºæ¥</span></span><br><span class="line">d.name; <span class="comment">// 1</span></span><br><span class="line">d.name = <span class="number">3</span>; <span class="comment">// å°è¯•ä¿®æ”¹ name å±æ€§ </span></span><br><span class="line">d.name; <span class="comment">// 1</span></span><br></pre></td></tr></table></figure><p></p><p>æˆ‘ä»¬å‘ç°ï¼Œé…ç½®äº†å¯å†™å…¥é¡¹ä¸º false æ—¶ï¼Œæˆ‘ä»¬å°±æ— æ³•å»ä¿®æ”¹å¯¹è±¡å±æ€§çš„å€¼äº†ï¼Œæœ‰ç‚¹åƒå†»ç»“çš„æ„æ€ã€‚åˆšå¥½ï¼ŒJS æœ‰ä¸ª <code>Object.freeze()</code>ï¼Œ æ¥çœ‹ä¸€ä¸‹<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> c = &#123;<span class="attr">name</span>: <span class="number">1</span>&#125;;</span><br><span class="line"><span class="built_in">Object</span>.freeze(c);</span><br><span class="line">c.name = <span class="number">3</span>;</span><br><span class="line"><span class="built_in">console</span>.log(c) <span class="comment">// &#123;a: 1&#125;</span></span><br></pre></td></tr></table></figure><p></p><p>å‘ç°å’Œæˆ‘ä»¬è‡ªå·±å»é…ç½® <code>writeble: false</code> æ•ˆæœç›¸åŒã€‚ä¸ä¿¡ï¼Ÿæ¥éªŒè¯ä¸€ä¸‹ï¼š<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Object</span>.getOwnPropertyDescriptor(c);</span><br><span class="line"><span class="comment">// è¿”å›ï¼š </span></span><br><span class="line">&#123;</span><br><span class="line">	 name: &#123;</span><br><span class="line">	 configurable: <span class="literal">false</span></span><br><span class="line">	 enumerable: <span class="literal">true</span></span><br><span class="line">	 value: <span class="number">1</span></span><br><span class="line">	 writable: <span class="literal">false</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><h3 id="ES6-è¿˜è¦è¿™ä¹ˆå†™å—ï¼Ÿ"><a href="#ES6-è¿˜è¦è¿™ä¹ˆå†™å—ï¼Ÿ" class="headerlink" title="ES6 è¿˜è¦è¿™ä¹ˆå†™å—ï¼Ÿ"></a>ES6 è¿˜è¦è¿™ä¹ˆå†™å—ï¼Ÿ</h3><p>ä¸ç”¨ã€‚ç›´æ¥ç”¨<code>è£…é¥°å™¨ decorator</code>æ¥å†™ã€‚</p><h4 id="ç¬¬ä¸€ç§ï¼Œç›´æ¥è£…é¥°-classï¼Œ"><a href="#ç¬¬ä¸€ç§ï¼Œç›´æ¥è£…é¥°-classï¼Œ" class="headerlink" title="ç¬¬ä¸€ç§ï¼Œç›´æ¥è£…é¥° classï¼Œ"></a>ç¬¬ä¸€ç§ï¼Œç›´æ¥è£…é¥° classï¼Œ</h4><p>ä½œç”¨ï¼š ç»™ç±»å¢åŠ åŠ¨æ€å±æ€§ï¼Œè¯¥åŠ¨æ€å±æ€§å¹¶ä¸ä¼šè¢«ç»§æ‰¿ï¼Œåªèƒ½ä½œä¸º <strong>è¢«è£…é¥°ç±»</strong> çš„ é™æ€å±æ€§ã€‚<br>æ³¨æ„ï¼š ç»™ç±»æ·»åŠ é™æ€å±æ€§çš„è¿™ç§è¡Œä¸ºï¼Œæ˜¯åœ¨ <strong>ç¼–è¯‘æ—¶</strong> å‘ç”Ÿçš„ï¼æ‰€ä»¥è¯´ï¼š<br><strong>è£…é¥°å™¨çš„æœ¬è´¨å°±æ˜¯ç¼–è¯‘æ—¶è¿è¡Œçš„å‡½æ•°</strong><br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">addFlag</span>(<span class="params">object</span>) </span>&#123;</span><br><span class="line">object.flag = <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@addFlag</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo</span>()</span>&#123;&#125;</span><br><span class="line">Foo.flag <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ¥ä¸ªå®ä¾‹</span></span><br><span class="line"><span class="keyword">const</span> f1 = <span class="keyword">new</span> Foo();</span><br><span class="line">f1.flag <span class="comment">// undefined</span></span><br></pre></td></tr></table></figure><p></p><h4 id="ç¬¬äºŒç§ï¼Œè£…é¥°å±æ€§"><a href="#ç¬¬äºŒç§ï¼Œè£…é¥°å±æ€§" class="headerlink" title="ç¬¬äºŒç§ï¼Œè£…é¥°å±æ€§"></a>ç¬¬äºŒç§ï¼Œè£…é¥°å±æ€§</h4><p>è£…é¥°å™¨ä¼šåœ¨ <code>Object.defineProperty</code> ä¹‹å‰æ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯æ‹¦æˆªé»˜è®¤çš„è®¿é—®ä¿®é¥°ç¬¦ã€‚<br>ä¸¾ä¸ªä¾‹å­:<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// CSDN markdown ç¼–è¾‘å™¨ ä¸ºä»€ä¹ˆä¸æ”¯æŒ typescript é«˜äº®ï¼Ÿæ— è¯­...</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">nameEqual3</span>(<span class="params">object, key, descriptor: PropertyDescriptor</span>) </span>&#123;</span><br><span class="line">    descriptor.value = <span class="number">3</span>;</span><br><span class="line">    descriptor.writable = <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    @nameEqual3</span><br><span class="line">    name() &#123; &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> p = <span class="keyword">new</span> Person();</span><br><span class="line"><span class="built_in">console</span>.log(p.name); <span class="comment">// 3</span></span><br></pre></td></tr></table></figure><p></p><p>å¯è§å…¶æ•ˆæœã€‚<br>ä¹Ÿæ”¯æŒä¼ å‚ï¼Œå¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼Œè¯·ä»”ç»†é˜…è¯»æ³¨é‡Šï¼š<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è£…é¥°å™¨å‡½æ•° (ç”¨é—­åŒ…æ¥å°è£…ä¸€ä¸‹)</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sign</span>(<span class="params">id</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params">target, name, descriptor</span>) </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *  è¿™é‡Œçš„ value åœ¨æˆ‘çœ‹æ¥ï¼Œæ›´åƒæ˜¯ä¸€ä¸ª getter, æ‰€ä»¥å¯ä»¥ç›´æ¥è¢«èµ‹å€¼æˆä¸€ä¸ªå‡½æ•°</span></span><br><span class="line"><span class="comment">     *  ç±»ä¼¼äºï¼š</span></span><br><span class="line"><span class="comment">     *  descriptor = &#123;</span></span><br><span class="line"><span class="comment">     *     get: function()&#123; return this.value &#125; </span></span><br><span class="line"><span class="comment">     *  &#125;</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">const</span> oldValue = descriptor.value;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¿™é‡Œçš„ args å®é™…ä¸Šå°±æ˜¯è£…é¥°å™¨åœ¨è¿è¡Œæ—¶ï¼ŒæŒ‚è½½çš„å‡½æ•°çš„å…¥å‚ï¼Œä¸‹é¢çš„ log æ—¥å¿—ä¼šè¯æ˜</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    descriptor.value = <span class="function"><span class="keyword">function</span> (<span class="params">...args</span>) </span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">`args =&gt;`</span>, args);</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">`æ ‡è®° <span class="subst">$&#123;id&#125;</span>`</span>);</span><br><span class="line">      <span class="keyword">return</span> oldValue.apply(<span class="keyword">this</span>, args);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> descriptor;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">  @sign(<span class="number">1</span>)</span><br><span class="line">  method(a, b) &#123;</span><br><span class="line">    <span class="keyword">return</span> a + b;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®ä¾‹åŒ–å’Œè°ƒç”¨</span></span><br><span class="line"><span class="keyword">const</span> p1 = <span class="keyword">new</span> Person();</span><br><span class="line">p1.method(<span class="number">2</span>, <span class="number">4</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¾“å‡ºï¼š</span></span><br><span class="line"> args =&gt; [<span class="number">3</span>,<span class="number">4</span>]</span><br><span class="line"> æ ‡è®° <span class="number">1</span></span><br></pre></td></tr></table></figure><p></p><h4 id="ç¬¬ä¸‰ç§ï¼Œè£…é¥°å™¨çš„é«˜çº§ç”¨æ³•ï¼ˆé“¾å¼è°ƒç”¨-combine-ä»¥åŠ-mixin"><a href="#ç¬¬ä¸‰ç§ï¼Œè£…é¥°å™¨çš„é«˜çº§ç”¨æ³•ï¼ˆé“¾å¼è°ƒç”¨-combine-ä»¥åŠ-mixin" class="headerlink" title="ç¬¬ä¸‰ç§ï¼Œè£…é¥°å™¨çš„é«˜çº§ç”¨æ³•ï¼ˆé“¾å¼è°ƒç”¨, combine ä»¥åŠ mixin)"></a>ç¬¬ä¸‰ç§ï¼Œè£…é¥°å™¨çš„é«˜çº§ç”¨æ³•ï¼ˆé“¾å¼è°ƒç”¨, combine ä»¥åŠ mixin)</h4><h5 id="1-é“¾å¼ï¼ˆè¿ç»­ï¼‰"><a href="#1-é“¾å¼ï¼ˆè¿ç»­ï¼‰" class="headerlink" title="1.é“¾å¼ï¼ˆè¿ç»­ï¼‰"></a>1.é“¾å¼ï¼ˆè¿ç»­ï¼‰</h5><p>é¦–å…ˆæ¥çœ‹é“¾å¼ï¼ˆè¿ç»­ï¼‰è°ƒç”¨ï¼Œè¿™æ¬¡å¤šåŠ ä¸€ä¸ªè£…é¥°å™¨ï¼Œå¹¶ä¸”ç»§ç»­é€šè¿‡æ‰“å°çš„æ–¹å¼æ¥æŸ¥çœ‹ä¸‹è°ƒç”¨çš„é¡ºåºï¼š<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// è£…é¥°å™¨å‡½æ•° å† å°è£…ä¸€å±‚</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">mark</span>(<span class="params">id</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// çœŸæ­£çš„è£…é¥°å™¨å‡½æ•°ä»¥é—­åŒ…å½¢å¼è¿”å›</span></span><br><span class="line">  <span class="keyword">return</span> <span class="function">(<span class="params">obj, target, descriptor</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// ä¸ç ´ååŸ getter å‡½æ•°</span></span><br><span class="line">    <span class="keyword">const</span> old = descriptor.value;</span><br><span class="line">    <span class="built_in">console</span>.log(id);</span><br><span class="line">    <span class="keyword">return</span> descriptor.value = <span class="function"><span class="params">()</span> =&gt;</span> old.apply(<span class="keyword">this</span>, id);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  @mark(<span class="number">1</span>)</span><br><span class="line">  @mark(<span class="number">2</span>)</span><br><span class="line">  method() &#123; &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> p1 = <span class="keyword">new</span> Person();</span><br><span class="line"></span><br><span class="line">p1.method();</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¾“å‡ºï¼š</span></span><br><span class="line"><span class="number">2</span> </span><br><span class="line"><span class="number">1</span></span><br></pre></td></tr></table></figure><p></p><p>å’¦ï¼Ÿæ˜æ˜ <code>@mark(1)</code> åœ¨ <code>@mark(2)</code> ä¹‹å‰è°ƒç”¨çš„å•Šï¼Œä¸ºä»€ä¹ˆ 2 æ¯” 1 å…ˆæ‰§è¡Œäº†å‘¢ï¼Ÿ<br>è®©æˆ‘ä»¬æ‰“å¼€ å¦‚ä¸‹åœ°å€ï¼Œè·Ÿç€æˆ‘ä¸€èµ·åˆ†æï¼š<br><a href="http://www.typescriptlang.org/play/#src=%0D%0A%2F%2F%20%E8%A3%85%E9%A5%B0%E5%99%A8%E5%87%BD%E6%95%B0%20%E5%86%8D%20%E5%B0%81%E8%A3%85%E4%B8%80%E5%B1%82%0D%0Afunction%20mark(id" target="_blank" rel="noopener">Type Script - Play ground</a>%20%7B%0D%0A%20%20%2F%2F%20%E7%9C%9F%E6%AD%A3%E7%9A%84%E8%A3%85%E9%A5%B0%E5%99%A8%E5%87%BD%E6%95%B0%E4%BB%A5%E9%97%AD%E5%8C%85%E5%BD%A2%E5%BC%8F%E8%BF%94%E5%9B%9E%0D%0A%20%20return%20(obj%2C%20target%2C%20descriptor)%20%3D%3E%20%7B%0D%0A%20%20%20%20%2F%2F%20%E4%B8%8D%E7%A0%B4%E5%9D%8F%E5%8E%9F%20getter%20%E5%87%BD%E6%95%B0%0D%0A%20%20%20%20const%20old%20%3D%20descriptor.value%3B%0D%0A%20%20%20%20console.log(id)%3B%0D%0A%20%20%20%20return%20descriptor.value%20%3D%20()%20%3D%3E%20old.apply(this%2C%20id)%3B%0D%0A%20%20%7D%0D%0A%7D%0D%0A%0D%0A%0D%0A%0D%0Aclass%20Person%20%7B%0D%0A%0D%0A%20%20%40mark(1)%0D%0A%20%20%40mark(2)%0D%0A%20%20method()%20%7B%20%7D%0D%0A%7D%0D%0A%0D%0A%0D%0Aconst%20p1%20%3D%20new%20Person()%3B%0D%0A%0D%0Ap1.method()%3B%0D%0A%0D%0A%2F%2F%20%E8%BE%93%E5%87%BA%EF%BC%9A%0D%0A2%20%0D%0A1)<br>æ¥çœ‹å³è¾¹ç¼–è¯‘åçš„ javascript ä»£ç ï¼Œåªçœ‹ var decorator è¢«ç¼–è¯‘æˆäº†å•¥ï¼Œä¸‹é¢çš„ä¸ç”¨çœ‹ï¼Œè·Ÿæºç å·®ä¸å¤šã€‚<strong>è¯·ä»”ç»†é˜…è¯»æ³¨é‡Š</strong><br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> __decorate = (<span class="keyword">this</span> &amp;&amp; <span class="keyword">this</span>.__decorate) || <span class="function"><span class="keyword">function</span> (<span class="params">decorators, target, key, desc</span>) </span>&#123;</span><br><span class="line"><span class="comment">// åˆ¤æ–­å‡½æ•°çœŸæ­£çš„å…¥å‚ï¼Œå¦‚æœå°äº 3 ä¸ªï¼Œr = target å¦åˆ™ ç»§ç»­åˆ¤æ–­ ï¼Œåœ¨è¯¥ å¯¹è±¡ çš„å±æ€§ï¼ˆè¢«è£…é¥°çš„å±æ€§ï¼‰ä¸ŠåŸæœ¬çš„ descriptor æ˜¯ä¸æ˜¯ null ï¼Ÿ å¦‚æœæ˜¯ï¼Œåˆ™ desc ç­‰äº å½“å‰å¯¹è±¡è¢«è£…é¥°å±æ€§çš„ descriptor ï¼Œå¦åˆ™ r = å½“å‰å¯¹è±¡è¢«è£…é¥°å±æ€§çš„ descriptor</span></span><br><span class="line"><span class="comment">// è¿™é‡Œçš„ d ç”¨äºç¼“å­˜ ä¸‹é¢éå†æ—¶ çš„ çŠ¶æ€</span></span><br><span class="line">    <span class="keyword">var</span> c = <span class="built_in">arguments</span>.length, r = c &lt; <span class="number">3</span> ? target : desc === <span class="literal">null</span> ? desc = <span class="built_in">Object</span>.getOwnPropertyDescriptor(target, key) : desc, d;</span><br><span class="line">    <span class="comment">// è¿™é‡Œçš„ Reflect æ˜¯ window ä¸‹çš„ å…¨å±€å¯¹è±¡ï¼Œæˆ‘ä»¬ä¹ŸçŸ¥é“ï¼Œ Reflect å¯¹è±¡æ ¹æœ¬æ²¡æœ‰ decorate æ–¹æ³•ï¼Œæ‰€ä»¥ï¼Œ turthy çš„åˆ†æ”¯å¹¶ä¸ä¼šæ‰§è¡Œï¼Œè€Œæ˜¯èµ° falsy åˆ†æ”¯.</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="built_in">Reflect</span> === <span class="string">"object"</span> &amp;&amp; <span class="keyword">typeof</span> <span class="built_in">Reflect</span>.decorate === <span class="string">"function"</span>) r = <span class="built_in">Reflect</span>.decorate(decorators, target, key, desc);</span><br><span class="line">    <span class="comment">/**********å…³é”®æ­¥éª¤************/</span></span><br><span class="line">    <span class="comment">// è¿™é‡Œéå†çš„æ˜¯å…¥å‚çš„è£…é¥°å™¨æ•°ç»„ï¼Œå¹¶ä¸”ï¼Œä»å³å€’å™éå†ï¼ˆèµ·å§‹ä¸‹æ ‡ä¸º decorators.length - 1ï¼‰</span></span><br><span class="line">    <span class="comment">// d æ˜¯æ¯æ¬¡éå†çš„ è£…é¥°å™¨è¿”å›çš„ descriptor, é€šè¿‡ åˆ¤æ–­å…¥å‚ä¸ªæ•°ï¼Œæ¥å†³å®š r çš„ç±»å‹ï¼Œä»¥åŠæ˜¯å¦é€šè¿‡ d(r) æ¥è£…é¥°æŸä¸ªå¯¹è±¡ã€‚å¦‚æœ å…¥å‚ &lt; 3 ä¸ªï¼Œå³ r ä¸º ä¸€ä¸ªå¯¹è±¡ï¼Œæ‰§è¡Œ d(r) ï¼› å¦åˆ™å¦‚æœ å…¥å‚ &gt; 3 ä¸ªï¼Œå³è¿è¡Œæ—¶ä¼ å…¥äº†ç¬¬å››ä¸ªå‚æ•° desc(descriptor) ï¼Œ æ­¤æ—¶çš„ r å…¶å®å°±æ˜¯ desc ï¼Œd(target, key, r) æ„æ€æ˜¯ï¼šç”¨ å…¥å‚çš„ desc è£…é¥°å¯¹è±¡ target çš„ key å±æ€§ï¼›å¦åˆ™ c &lt; 4 ï¼Œ æ­¤æ—¶çš„ r  ä¸º object å¯¹è±¡ï¼Œd(target, key)ï¼›</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">for</span> (<span class="keyword">var</span> i = decorators.length - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) <span class="keyword">if</span> (d = decorators[i]) r = (c &lt; <span class="number">3</span> ? d(r) : c &gt; <span class="number">3</span> ? d(target, key, r) : d(target, key)) || r;</span><br><span class="line">    <span class="keyword">return</span> c &gt; <span class="number">3</span> &amp;&amp; r &amp;&amp; <span class="built_in">Object</span>.defineProperty(target, key, r), r;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*************************ä¸‹é¢è¿™äº›å…ˆä¸ç”¨çœ‹***********************/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// è£…é¥°å™¨å‡½æ•° å† å°è£…ä¸€å±‚</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">mark</span>(<span class="params">id</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> _this = <span class="keyword">this</span>;</span><br><span class="line">    <span class="comment">// çœŸæ­£çš„è£…é¥°å™¨å‡½æ•°ä»¥é—­åŒ…å½¢å¼è¿”å›</span></span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params">obj, target, descriptor</span>) </span>&#123;</span><br><span class="line">        <span class="comment">// ä¸ç ´ååŸ getter å‡½æ•°</span></span><br><span class="line">        <span class="keyword">var</span> old = descriptor.value;</span><br><span class="line">        <span class="built_in">console</span>.log(id);</span><br><span class="line">        <span class="keyword">return</span> descriptor.value = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="keyword">return</span> old.apply(_this, id); &#125;;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> Person = <span class="comment">/** @class */</span> (<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">    Person.prototype.method = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; &#125;;</span><br><span class="line">    __decorate([</span><br><span class="line">        mark(<span class="number">1</span>),</span><br><span class="line">        mark(<span class="number">2</span>)</span><br><span class="line">    ], Person.prototype, <span class="string">"method"</span>, <span class="literal">null</span>);</span><br><span class="line">    <span class="keyword">return</span> Person;</span><br><span class="line">&#125;());</span><br><span class="line"><span class="keyword">var</span> p1 = <span class="keyword">new</span> Person();</span><br><span class="line">p1.method();</span><br></pre></td></tr></table></figure><p></p><p>ä¸Šé¢å•°é‡Œå•°å”†çš„æ³¨é‡Šæ˜¯å•¥æ„æ€å‘¢ï¼Ÿ<br>ç¿»è¯‘æˆäººè¯ï¼š è£…é¥°å™¨çš„æ‰§è¡Œé¡ºåºæ˜¯ä¸ª æ ˆï¼Œ åè¿›å…ˆå‡ºã€‚åƒæäº†â€¦ çˆ±æƒ…ï¼Ÿä¸ï¼Œåƒæäº† <strong>æ´‹è‘±æ¨¡å‹</strong>ã€‚</p><h5 id="2-combine-åˆå¹¶"><a href="#2-combine-åˆå¹¶" class="headerlink" title="2. combine (åˆå¹¶)"></a>2. combine (åˆå¹¶)</h5><p>åˆå¹¶æŒ‡çš„æ˜¯è£…é¥°å™¨è£…é¥°æŸä¸ªç±»çš„å±æ€§çš„æ—¶å€™ï¼ŒåŒæ—¶åº”ç”¨å¤šä¸ªè£…é¥°å™¨çš„æ¨¡å¼ã€‚ï¼ˆè¦è·Ÿä¸‹é¢çš„ <code>@mixin</code>ï¼‰åŒºåˆ†<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">eatApple</span>(<span class="params">count</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function">(<span class="params">obj,target,descriptor</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> old = descriptor.value;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`åƒäº† <span class="subst">$&#123;count&#125;</span> ä¸ª è‹¹æœ`</span>);</span><br><span class="line">    <span class="keyword">return</span> old.apply(<span class="keyword">this</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">runMeter</span>(<span class="params">long</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function">(<span class="params">obj,target,descriptor</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> old = descriptor.value;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`è·‘äº† <span class="subst">$&#123;long&#125;</span> ç±³`</span>);</span><br><span class="line">    <span class="keyword">return</span> old.apply(<span class="keyword">this</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">combine</span>(<span class="params">...descriptors</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// æƒ³ç‚¹åŠæ³•ï¼Œè®©å…¥å‚çš„æ¯ä¸ªå‡½æ•°ç«‹é©¬æ‰§è¡Œï¼è¦æŠŠè‡ªå·±å¾—åˆ°çš„å¯¹è±¡åˆ†é…ç»™ä¸¤ä¸ªå°å¼Ÿ</span></span><br><span class="line">  <span class="keyword">return</span> <span class="function">(<span class="params">obj, target, descriptor</span>) =&gt;</span> descriptors.forEach(<span class="function"><span class="params">d</span> =&gt;</span> d.apply(<span class="keyword">this</span>, [obj, target, descriptor]));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  @combine(eatApple(<span class="number">1</span>), runMeter(<span class="number">9</span>))</span><br><span class="line">  method() &#123; &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> p1 = <span class="keyword">new</span> Person();</span><br><span class="line"></span><br><span class="line">p1.method();</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¾“å‡ºï¼š</span></span><br><span class="line">åƒäº†ä¸€ä¸ªè‹¹æœ</span><br><span class="line">è·‘äº† <span class="number">9</span> ç±³</span><br></pre></td></tr></table></figure><p></p><p>å¯è§ï¼Œåœ¨ <code>@combine()</code> ä¸­ä¼ å…¥çš„å‚æ•°é¡ºåºï¼Œç«Ÿç„¶è·Ÿæœ€ç»ˆçš„é¡ºåº æ˜¯ä¸€æ ·çš„ï¼Œå’¦ï¼Ÿä¸æ˜¯æ´‹è‘±å—ï¼Ÿè¿™å‹æ ¹ä¸æ˜¯æ ˆå•Šï¼<br>è„‘å­é‡Œå›æƒ³ä¸€ä¸‹åˆšæ‰è§£ææºç çš„è¿‡ç¨‹ï¼Œæˆ‘å†æ¬¡æœ›å‘äº†è¿™æ¬¡çš„æºç ï¼š<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> Person = <span class="comment">/** @class */</span> (<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">    Person.prototype.method = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; &#125;;</span><br><span class="line">    __decorate([</span><br><span class="line">        combine(eatApple(<span class="number">1</span>), runMeter(<span class="number">9</span>))</span><br><span class="line">    ], Person.prototype, <span class="string">"method"</span>, <span class="literal">null</span>);</span><br><span class="line">    <span class="keyword">return</span> Person;</span><br></pre></td></tr></table></figure><p></p><p>æ˜¾è€Œæ˜“è§ï¼Œè¿™ä¸¤ä¸ªå‡½æ•°ï¼Œç›´æ¥æ˜¯ä½œä¸ºç»“æœè¢«ä¼ è¿›å»çš„ï¼Œç›¸å½“äºæ ˆé‡Œé¢åªæœ‰ <code>mixin</code> ä¸€ä¸ªå‡½æ•°ï¼Œæ— æ‰€è°“æ˜¯æ ˆæˆ–è€…é˜Ÿåˆ—äº†ï¼Œåæ­£ä¸¤ä¸ªå‡½æ•°éƒ½åœ¨æˆ‘å†…éƒ¨æ‰§è¡Œï¼Œæˆ‘è®©ä»–æ€ä¹ˆæ‰§è¡Œå°±æ€ä¹ˆæ‰§è¡Œï¼Œä¸ºæ‰€æ¬²ä¸ºã€‚æ‰€ä»¥è¿™é‡Œçš„è¾“å‡ºç»“æœæ˜¯åŒæ­¥çš„ï¼Œå®Œå…¨å°±æ˜¯å› ä¸ºæ ˆé‡Œåªæœ‰ä¸€ä¸ª memberã€‚<br>ä¸ä¿¡éªŒè¯ä¸€ä¸‹ï¼š<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">eatApple</span>(<span class="params">count</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function">(<span class="params">obj,target,descriptor</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> old = descriptor.value;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`åƒäº† <span class="subst">$&#123;count&#125;</span> ä¸ª è‹¹æœ`</span>);</span><br><span class="line">    <span class="keyword">return</span> old.apply(<span class="keyword">this</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">runMeter</span>(<span class="params">long</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function">(<span class="params">obj,target,descriptor</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> old = descriptor.value;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`è·‘äº† <span class="subst">$&#123;long&#125;</span> ç±³`</span>);</span><br><span class="line">    <span class="keyword">return</span> old.apply(<span class="keyword">this</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">combine</span>(<span class="params">...descriptors</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// æƒ³ç‚¹åŠæ³•ï¼Œè®©å…¥å‚çš„æ¯ä¸ªå‡½æ•°ç«‹é©¬æ‰§è¡Œï¼è¦æŠŠè‡ªå·±å¾—åˆ°çš„å¯¹è±¡åˆ†é…ç»™ä¸¤ä¸ªå°å¼Ÿ</span></span><br><span class="line">  <span class="keyword">return</span> <span class="function">(<span class="params">obj, target, descriptor</span>) =&gt;</span> descriptors.forEach(<span class="function"><span class="params">d</span> =&gt;</span> d.apply(<span class="keyword">this</span>, [obj, target, descriptor]));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  @combine(eatApple(<span class="number">1</span>), runMeter(<span class="number">9</span>))</span><br><span class="line">  @combine(eatApple(<span class="number">5</span>),runMeter(<span class="number">100</span>))</span><br><span class="line">  method() &#123; &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> p1 = <span class="keyword">new</span> Person();</span><br><span class="line"></span><br><span class="line">p1.method();</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¾“å‡ºï¼š</span></span><br><span class="line">åƒäº† <span class="number">5</span> ä¸ª è‹¹æœ</span><br><span class="line">è·‘äº† <span class="number">100</span> ç±³</span><br><span class="line">åƒäº† <span class="number">1</span> ä¸ª è‹¹æœ</span><br><span class="line">è·‘äº† <span class="number">9</span> ç±³</span><br></pre></td></tr></table></figure><p></p><h5 id="3-mixin-æ··åˆ"><a href="#3-mixin-æ··åˆ" class="headerlink" title="3. mixin (æ··åˆ)"></a>3. mixin (æ··åˆ)</h5><p>mixin æ„ä¸ºåœ¨ä¸€ä¸ªå¯¹è±¡ä¹‹ä¸­æ··å…¥å¦å¤–ä¸€ä¸ªå¯¹è±¡çš„æ–¹æ³•ã€‚<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">mixins</span>(<span class="params">...list</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params">target</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// Object.assign å¯ç”¨äºå¯¹è±¡ï¼Œå³ ç¼–è¯‘åçš„ es3 runtime æŒ‡å‘ class.prototype</span></span><br><span class="line">    <span class="built_in">Object</span>.assign(target.prototype, ...list);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> Foo = &#123;</span><br><span class="line">  foo() &#123; <span class="built_in">console</span>.log(<span class="string">'foo'</span>) &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">@mixins(Foo)</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> obj = <span class="keyword">new</span> MyClass();</span><br><span class="line">obj.foo() <span class="comment">// "foo"</span></span><br></pre></td></tr></table></figure><p></p><p><b>ğŸ˜˜ è§‰å¾—æ–‡ç« æœ‰ç”¨ï¼Ÿç‚¹å‡»ä¸‹æ–¹æ‰“èµï¼Œé¼“åŠ±ä½œè€…æ›´å¥½çš„å†™ä½œï¼</b></p></div><blockquote class="post-copyright"><div class="content">è½¬è½½æ³¨æ˜å‡ºå¤„ï¼ŒåŸæ–‡åœ°å€ï¼š<a href="/2019/06/13/ES7 decorator æ·±å…¥æ¢æ/" target="_blank" rel="external">https://ZQ-jhon.github.io/2019/06/13/ES7 decorator æ·±å…¥æ¢æ/</a></div></blockquote><div class="page-reward"><h5>ğŸ˜˜ è§‰å¾—æ–‡ç« æœ‰ç”¨ï¼Ÿç‚¹å‡»ä¸‹æ–¹æ‰“èµï¼Œé¼“åŠ±ä½œè€…æ›´å¥½çš„åˆ›ä½œï¼</h5><br><a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-circle waves-light">èµ</a></div><div class="post-footer"><ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/decorator/">decorator</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/">javascript</a></li></ul><div class="page-share-wrap"><div class="page-share" id="pageShare"><ul class="reset share-icons"><li><a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://ZQ-jhon.github.io/2019/06/13/ES7 decorator æ·±å…¥æ¢æ/&title=ã€ŠES7 decorator æ·±å…¥æ¢æã€‹ â€” Keep Moving&pic=https://ZQ-jhon.github.io/img/avatar.png" data-title="å¾®åš"><i class="icon icon-weibo"></i></a></li><li><a class="weixin share-sns wxFab" href="javascript:;" data-title="å¾®ä¿¡"><i class="icon icon-weixin"></i></a></li><li><a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://ZQ-jhon.github.io/2019/06/13/ES7 decorator æ·±å…¥æ¢æ/&title=ã€ŠES7 decorator æ·±å…¥æ¢æã€‹ â€” Keep Moving&source=F2E" data-title=" QQ"><i class="icon icon-qq"></i></a></li><li><a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://ZQ-jhon.github.io/2019/06/13/ES7 decorator æ·±å…¥æ¢æ/" data-title=" Facebook"><i class="icon icon-facebook"></i></a></li><li><a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=ã€ŠES7 decorator æ·±å…¥æ¢æã€‹ â€” Keep Moving&url=https://ZQ-jhon.github.io/2019/06/13/ES7 decorator æ·±å…¥æ¢æ/&via=https://ZQ-jhon.github.io" data-title=" Twitter"><i class="icon icon-twitter"></i></a></li><li><a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://ZQ-jhon.github.io/2019/06/13/ES7 decorator æ·±å…¥æ¢æ/" data-title=" Google+"><i class="icon icon-google-plus"></i></a></li></ul></div><a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle"><i class="icon icon-share-alt icon-lg"></i></a></div></div><div id="comment"></div></div><nav class="post-nav flex-row flex-justify-between"><div class="prev"><a href="/2019/06/20/regExp/" id="post-prev" class="post-nav-link"><div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div><h4 class="title">æ­£åˆ™å¤ä¹ </h4></a></div><div class="next"><a href="/2019/06/11/hello-sql/" id="post-next" class="post-nav-link"><div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div><h4 class="title">hello-sql</h4></a></div></nav><aside class="post-widget"><nav class="post-toc-wrap" id="post-toc"><strong>ç›®å½•</strong><ol class="post-toc"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#èµ·å› "><span class="post-toc-number">1.</span> <span class="post-toc-text">èµ·å› </span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#å‰ç½®æ¡ä»¶ï¼ˆes5-åŸç†ï¼‰"><span class="post-toc-number">2.</span> <span class="post-toc-text">å‰ç½®æ¡ä»¶ï¼ˆes5 åŸç†ï¼‰</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#ES6-è¿˜è¦è¿™ä¹ˆå†™å—ï¼Ÿ"><span class="post-toc-number">3.</span> <span class="post-toc-text">ES6 è¿˜è¦è¿™ä¹ˆå†™å—ï¼Ÿ</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#ç¬¬ä¸€ç§ï¼Œç›´æ¥è£…é¥°-classï¼Œ"><span class="post-toc-number">3.1.</span> <span class="post-toc-text">ç¬¬ä¸€ç§ï¼Œç›´æ¥è£…é¥° classï¼Œ</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#ç¬¬äºŒç§ï¼Œè£…é¥°å±æ€§"><span class="post-toc-number">3.2.</span> <span class="post-toc-text">ç¬¬äºŒç§ï¼Œè£…é¥°å±æ€§</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#ç¬¬ä¸‰ç§ï¼Œè£…é¥°å™¨çš„é«˜çº§ç”¨æ³•ï¼ˆé“¾å¼è°ƒç”¨-combine-ä»¥åŠ-mixin"><span class="post-toc-number">3.3.</span> <span class="post-toc-text">ç¬¬ä¸‰ç§ï¼Œè£…é¥°å™¨çš„é«˜çº§ç”¨æ³•ï¼ˆé“¾å¼è°ƒç”¨, combine ä»¥åŠ mixin)</span></a></li></ol></li></ol></nav><div class="toc-bar"><div></div></div></aside></article><div id="reward" class="page-modal reward-lay"><a class="close" href="javascript:;"><i class="icon icon-close"></i></a><h3 class="reward-title"><i class="icon icon-quote-left"></i> è¯·æˆ‘å–å’–å•¡ <i class="icon icon-quote-right"></i></h3><div class="reward-content"><div class="reward-code"><img id="rewardCode" src="/img/wechat.png" alt="æ‰“èµäºŒç»´ç "></div><label class="reward-toggle"><input id="rewardToggle" type="checkbox" class="reward-toggle-check" data-wechat="/img/wechat.png" data-alipay="/img/alipay.png"><div class="reward-toggle-ctrol"><span class="reward-toggle-item wechat">å¾®ä¿¡</span> <span class="reward-toggle-label"></span> <span class="reward-toggle-item alipay">æ”¯ä»˜å®</span></div></label></div></div></div><footer class="footer"><div class="bottom"><p><span>ZQ-jhon &copy; 2017 - 2020</span></p></div></footer></main><div class="mask" id="mask"></div><a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a><div class="global-share" id="globalShare"><ul class="reset share-icons"><li><a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://ZQ-jhon.github.io/2019/06/13/ES7 decorator æ·±å…¥æ¢æ/&title=ã€ŠES7 decorator æ·±å…¥æ¢æã€‹ â€” Keep Moving&pic=https://ZQ-jhon.github.io/img/avatar.png" data-title="å¾®åš"><i class="icon icon-weibo"></i></a></li><li><a class="weixin share-sns wxFab" href="javascript:;" data-title="å¾®ä¿¡"><i class="icon icon-weixin"></i></a></li><li><a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://ZQ-jhon.github.io/2019/06/13/ES7 decorator æ·±å…¥æ¢æ/&title=ã€ŠES7 decorator æ·±å…¥æ¢æã€‹ â€” Keep Moving&source=F2E" data-title=" QQ"><i class="icon icon-qq"></i></a></li><li><a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://ZQ-jhon.github.io/2019/06/13/ES7 decorator æ·±å…¥æ¢æ/" data-title=" Facebook"><i class="icon icon-facebook"></i></a></li><li><a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=ã€ŠES7 decorator æ·±å…¥æ¢æã€‹ â€” Keep Moving&url=https://ZQ-jhon.github.io/2019/06/13/ES7 decorator æ·±å…¥æ¢æ/&via=https://ZQ-jhon.github.io" data-title=" Twitter"><i class="icon icon-twitter"></i></a></li><li><a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://ZQ-jhon.github.io/2019/06/13/ES7 decorator æ·±å…¥æ¢æ/" data-title=" Google+"><i class="icon icon-google-plus"></i></a></li></ul></div><div class="page-modal wx-share" id="wxShare"><a class="close" href="javascript:;"><i class="icon icon-close"></i></a><p>æ‰«ä¸€æ‰«ï¼Œåˆ†äº«åˆ°å¾®ä¿¡</p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAN4AAADeCAAAAAB3DOFrAAACwElEQVR42u3aQY7bMBAEQP//0xsgpyCB5O4ZCnaA0snQeiUWD+S4h69XfP38vq7u/PxxJX+9f+a/96++f+zCw8PDGw396kqGeM/Lh3j/X1fjuRoDHh4e3tO8+5clG0P+OZmgY9OHh4eH91Fei7xfyvNJxMPDw/vfeW2B+6bkHeHx8PDwvoGXAPLQdpOp5uzDWQseHh5e95yiAfYNnx/s7+Hh4eEtuur7RbwNgttg4s0I8fDw8B7gJaHDWUC+hrfRcJS14OHh4a15bcP+VKTbbioHSmo8PDy8o7w8nG1fPyujZ9tPUUzj4eHhLXjtNpCz881gc3Qg+jGAh4eH9xiv7SXloUMeduyPxr7JWvDw8PAO8ZJSNbmfZAJtpNseYsDDw8P7FG8TpLbsPMJYjRAPDw/vKC9ZptvlPmmPbZ5fTCseHh7eA7xNMJGEEbOefh5JFCU+Hh4e3iFe/uN/FiW0hwPyaBgPDw/vU7y8gM7jgHxw7XvbAAUPDw/vLG/fZNoU0Ke2hMv7eHh4eA/wZg9tm1ibI7DtxEVtMDw8PLwFr23StwFuC5gV0MURfzw8PLw1bxbFzkrw9ml562t4gAAPDw9vwct/3s/CiLyRtjn1cDkqPDw8vKO8WWmbrLqbiCGZguIXAx4eHt7DvLwgngW1+3clVDw8PLznePlC3x7Gmr0+L+iHJT4eHh7emte+si1t82V9Vqa/+S88PDy8B3izVtZsO8mPHbSxRX1oAA8PD2/B2y/us5C3DYjbRh0eHh7ec7xNI+pUhJGHF20EjIeHh/ccL49H20MGeRssCR1mk4KHh4f3HK9tR90v1m2h/Fpc0caAh4eH9zW8+0W8PUzQbg8REg8PD++jvHYQydPaKKQ+6ICHh4f3GG8WRuRL9ixQaDenw1kLHh4e3qINtmll3SPzNTyfuGP9PTw8PLy/v/ML9Ie7YPVbTPEAAAAASUVORK5CYII=" alt="å¾®ä¿¡åˆ†äº«äºŒç»´ç "></div><script type="text/javascript" src="//cdn.bootcss.com/jquery/2.0.0/jquery.min.js"></script><script type="text/javascript" src="/js/plugins/fastclick.js?v=1.2.6"></script><script type="text/javascript" src="https://cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script><script type="text/javascript" src="/js/method.js?v=1.2.6"></script><script type="text/javascript" src="/js/blog.js?v=1.2.6"></script><script type="text/javascript" src="/js/plugins/local_search.js?v=1.2.6"></script><script type="text/javascript">var search_path="search.xml";0===search_path.length&&(search_path="search.xml");var path="/"+search_path;searchFunc(path,"local-search-input","local-search-result")</script><script type="text/javascript" src="https://cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script type="text/javascript" src="//unpkg.com/valine/dist/Valine.min.js"></script><script type="text/javascript" src="/js/plugins/valine.js?v=1.2.6"></script><script type="text/javascript" src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script><script type="text/javascript" src="/js/plugins/leancloud_visitors.js?v=1.2.6"></script><script>!function(){var e,t=document.title;document.addEventListener("visibilitychange",function(){document.hidden?(document.title="Where are u?",clearTimeout(e)):(document.title="Hello!",e=setTimeout(function(){document.title=t},2e3))})}()</script></body></html><!-- rebuild by neat -->